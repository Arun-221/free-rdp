name: Cloudflare Windows RDP (Web)

on:
  workflow_dispatch:

jobs:
  rdp:
    runs-on: windows-latest
    timeout-minutes: 360
    env:
      CF_TUNNEL_TOKEN: ${{ secrets.CF_TUNNEL_TOKEN }}

    steps:
    - name: Enable User
      run: |
        net user runneradmin P@ssw0rd123 /add
        net localgroup administrators runneradmin /add

    - name: Download cloudflared
      run: |
        curl -L https://github.com/cloudflare/cloudflared/releases/latest/download/cloudflared-windows-amd64.exe -o cloudflared.exe

    - name: Start Cloudflare Tunnel
      run: |
        .\cloudflared.exe tunnel run --token $Env:CF_TUNNEL_TOKEN
